## 테스트할 수 있는 방법

사전 준비사항
- docker-desktop이 설치되어 있어야합니다.
- naver api key와 kakao api key를 넣어줘야합니다. (제출시 첨부하겠습니다. 해당 key 사용 부탁드립니다.)
- application.yaml에 key를 넣어줘야합니다. http 테스트 시에도 추가한 후 테스트 부탁드립니다.

1. 터미널에 docker-compose up -d 를 실행 (redis 실행을 위함)
2. 서버 실행
3. http repository에 있는 server-test.http 파일에서 요청 테스트 진행

## 장소 검색
### 고려한 사항
동일한 장소라고 어떻게 판단해야 하는지에 대한 결과로 지번 주소를 이용하기로 결정했습니다.
- x, y축을 사용해 동일 장소 판단을 진행하려 했는데, naver 좌표계와 kakao 좌표계가 달라 변환하는 방법 및 적용을 테스트해봤습니다. 네이버 좌표계 자체가 적용되어있다고 표기된 KTECH 좌표계와 다른 것으로 확인되어 이를 사용하지 않았습니다.
- 지번 주소를 받아 동일하다고 판단할 수 있는 근거를 지번까지의 결과를 통해 비교할 수 있도록 결정했습니다.
- 동일한 지번이라고 판단할 수 있도록 특별시, 특례시, 광역시 같은 접미사를 제거했습니다.

모든 검색 api가 실패했을 시 사용자에게 현재 사용이 불가능하다는 점을 알릴 수 있도록 구성했습니다.
- 둘 중 하나의 api라도 성공한 경우에는 해당 결과로 내려줄 수 있도록해 가용성을 높힐 수 있도록 했습니다.

반응성을 높이기 위해 각각의 검색 client 요청시 비동기로 처리할 수 있도록 코루틴을 사용했습니다.

## 검색 키워드 목록
### 고려한 사항
키워드 검색시 spring 내부 이벤트를 발행해 redis에 적재할 수 있도록 구현했습니다.

#### redis를 사용한 이유?
- 동시성 이슈를 고려했을 때, 해결방안으로 싱글 쓰레드로 동작하는 redis를 사용하도록 결정하고 반영했습니다.
- 추가적으로 키워드 목록 조회 요청이 많을 것을 판단해 redis를 저장소로 사용하기에 적합하다고 판단했습니다.

#### 이벤트 처리의 이유?
- keyword 목록 조회는 추세를 보는 의도가 강하다고 생각했습니다.
- 따라서 정확한 수치를 확인하는 것 보다는 near-real-time으로 확인할 수 있으면 된다고 판단했습니다.
- 또한 주 요청인 장소 검색이라는 비즈니스 로직에 영향이 없으면서도 키워드 적재가 가능해야한다고 판단해 이벤트로 처리할 수 있도록 구현했습니다.

## 어필하고 싶은 것
- keyword를 collect하는 기능은 데이터 관점에서 추가될 여지가 많다고 판단해 따로 service를 나눴습니다.
- redis의 특성을 이용해 동시성 이슈를 쉽게 해결할 수 있도록 구성했습니다.
- ktlint를 적용해 자동적으로 코드 포맷팅을 테스트할 수 있도록 구성했습니다.
- swagger 를 구성해 해당 api를 활용하는 사용자가 처리할 수 있도록 설명했습니다.
- 실제 테스트할 때, 부족한 부분을 잘 전달하기 위해 유닛테스트로 구성했습니다.
  - ex) 네이버 결과가 5개 미만인 경우 카카오 검색결과로 10개를 채운다
- API 제공자의 오류처리를 쉽게 하기 위해 client에서 http status code를 확인해 처리할 수 있도록 구현했습니다.
- 특정 검색 client가 실패하더라도 나머지 데이터로 보여줄 수 있어야한다고 판단해 모두 null인 경우에 사용자에게 예외를 내리는 식으로 구성했습니다. 
- 통합적으로 에러를 관리할 수 있도록 구성했습니다.

## 제약
- naver api의 응답이 5개 이상 오지 않습니다.
- 또한, 페이지네이션도 지원하지 않아서 다음 결과를 조회할 수 없습니다.
- 이는 naver api의 문제라고 생각하고 포럼에 질문을 올린 상태입니다.
